---
apiVersion: helm.toolkit.fluxcd.io/v2beta1
kind: HelmRelease
metadata:
  name: trilio-operator
  namespace: trilio
spec:
  interval: 5m
  releaseName: trilio-operator
  chart:
    spec:
      chart: k8s-triliovault-operator
      version: 2.9.2
      sourceRef:
        kind: HelmRepository
        name: trilio-charts
        namespace: flux-system
  values:
    preflight:
      enabled: false

    installTVK:
      enabled: true
      applicationScope: Cluster
      tvkInstanceName: "hegira"
      ingressConfig:
        host: "trilio.${EXTERNAL_DOMAIN}"
        tlsSecretName: "trilio.tls"
        annotations:
          external-dns.alpha.kubernetes.io/target: ipv4.${EXTERNAL_DOMAIN}
        ingressClass: "nginx"
      ComponentConfiguration:
        ingressController:
          enabled: false

    observability:
      enabled: true
      logging:
        loki:
          enabled: true
      monitoring:
        prometheus:
          enabled: true
          server:
            enabled: true
          alertmanager:
            enabled: true
      visualization:
        grafana:
          enabled: true
